# Default values for arl-operator
# This is a YAML-formatted file.

replicaCount: 1

image:
  repository: arl-operator
  pullPolicy: IfNotPresent
  tag: "latest"

sidecar:
  image:
    repository: arl-sidecar
    pullPolicy: IfNotPresent
    tag: "latest"
  httpPort: 8080
  grpcPort: 9090

# Executor agent configuration
executorAgent:
  image:
    repository: arl-executor-agent
    pullPolicy: IfNotPresent
    tag: "latest"

# Gateway configuration
gateway:
  enabled: true
  replicaCount: 1
  image:
    repository: arl-gateway
    pullPolicy: IfNotPresent
    tag: "latest"
  port: 8080
  sidecarGrpcPort: 9090
  resources:
    limits:
      cpu: 500m
      memory: 256Mi
    requests:
      cpu: 100m
      memory: 128Mi

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  annotations: {}
  name: ""

podAnnotations: {}

podSecurityContext: {}

securityContext: {}

resources:
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

nodeSelector: {}

tolerations: []

affinity: {}

# Operator configuration
operator:
  metricsAddr: ":8080"
  probeAddr: ":8081"
  enableLeaderElection: true
  enableWebhooks: false
  enableMetrics: true
  enableMiddleware: true
  workspaceDir: "/workspace"
  httpClientTimeout: "30s"

# Pool configuration
pool:
  defaultReplicas: 3
  defaultRequeueDelay: "10s"
  sandboxCheckInterval: "2s"

# Sandbox lifecycle configuration
sandbox:
  idleTimeoutSeconds: 3600
  maxLifetimeSeconds: 0

# ClickHouse configuration (for audit logging and trajectory)
clickhouse:
  # Enable ClickHouse deployment
  enabled: false
  # Image (use private registry since nodes cannot access Docker Hub)
  image:
    repository: pair-diag-cn-guangzhou.cr.volces.com/pair/clickhouse-server
    tag: "24.8"
    pullPolicy: IfNotPresent
  # Connection settings
  host: ""  # auto-resolved via helper to <fullname>-clickhouse
  port: 9000
  database: "arl"
  username: "default"
  password: "clickhouse123"
  batchSize: 100
  flushInterval: "10s"
  # Data retention
  retentionDays: 30
  # Storage configuration
  storageClassName: "ebs-ssd"
  storageSize: "10Gi"
  # Service configuration
  serviceType: "NodePort"
  httpNodePort: 30123   # Port for HTTP interface (8123)
  nativeNodePort: 30000 # Port for native protocol (9000)
  # Resources
  resources:
    requests:
      cpu: 500m
      memory: 2Gi
    limits:
      cpu: "1"
      memory: 4Gi

# CRD installation
crds:
  install: true
  keep: true
